SELECT CT.CONTEST_ID, HACKER_ID, NAME, SUM(TS), SUM(TAS), SUM(TV), SUM(TUV)
    FROM CONTESTS CT
    JOIN COLLEGES CL
    ON CT.CONTEST_ID=CL.CONTEST_ID
    JOIN CHALLENGES CH
    ON CH.COLLEGE_ID=CL.COLLEGE_ID
    LEFT JOIN (SELECT CHALLENGE_ID, SUM(TOTAL_VIEWS) TV, SUM(TOTAL_UNIQUE_VIEWS) TUV FROM VIEW_STATS GROUP BY CHALLENGE_ID) VS
    ON VS.CHALLENGE_ID=CH.CHALLENGE_ID
    LEFT JOIN (SELECT CHALLENGE_ID, SUM(TOTAL_SUBMISSIONS) TS, SUM(TOTAL_ACCEPTED_SUBMISSIONS) TAS FROM SUBMISSION_STATS GROUP BY CHALLENGE_ID) SS
    ON SS.CHALLENGE_ID=CH.CHALLENGE_ID
GROUP BY CT.CONTEST_ID, HACKER_ID, NAME
HAVING (SUM(TS)+ SUM(TAS)+ SUM(TV)+SUM(TUV))>0
ORDER BY CT.CONTEST_ID;
